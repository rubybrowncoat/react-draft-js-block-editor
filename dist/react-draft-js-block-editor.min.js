!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.DraftJsBlockEditor=e()}}(function(){return function e(t,n,o){function i(l,a){if(!n[l]){if(!t[l]){var u="function"==typeof require&&require;if(!a&&u)return u(l,!0);if(r)return r(l,!0);var s=new Error("Cannot find module '"+l+"'");throw s.code="MODULE_NOT_FOUND",s}var d=n[l]={exports:{}};t[l][0].call(d.exports,function(e){var n=t[l][1][e];return i(n?n:e)},d,d.exports,e,t,n,o)}return n[l].exports}for(var r="function"==typeof require&&require,l=0;l<o.length;l++)i(o[l]);return i}({1:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./editor"),r=o(i),l=e("./util/beforeinput"),a=o(l),u=e("./model/rendermap"),s=o(u);n.Editor=r["default"],n.beforeInput=a["default"],n.StringToTypeMap=l.StringToTypeMap,n.RenderMap=s["default"]},{"./editor":12,"./model/rendermap":14,"./util/beforeinput":15}],2:[function(e,t,n){(function(o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function(e,t,n){for(var o=!0;o;){var i=e,r=t,l=n;o=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,r);if(void 0!==a){if("value"in a)return a.value;var u=a.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(i);if(null===s)return;e=s,t=r,n=l,o=!0,a=s=void 0}},s="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,d=i(s),c=e("../util"),f=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={style:{},visible:!1},this.node=null,this.blockKey="",this.blockType="",this.blockLength=-1,this.findNode=this.findNode.bind(this),this.hideBlock=this.hideBlock.bind(this)}return l(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.editorState,n=t.getCurrentContent(),o=t.getSelection();if(!o.isCollapsed()||o.anchorKey!==o.focusKey)return void this.hideBlock();var i=n.getBlockForKey(o.anchorKey),r=i.getKey();return i.getLength()>0?void this.hideBlock():i.getType()!==this.blockType?(this.blockType=i.getType(),void(0===i.getLength()&&setTimeout(this.findNode,0))):this.blockKey===r?void(i.getLength()>0?this.hideBlock():this.setState({visible:!0})):(this.blockKey=r,i.getLength()>0?void this.hideBlock():void setTimeout(this.findNode,0))}},{key:"hideBlock",value:function(){this.state.visible&&this.setState({visible:!1})}},{key:"findNode",value:function(){var e=(0,c.getSelectedBlockNode)(window);if(e!==this.node){if(!e)return void this.setState({visible:!1});this.node=e,this.setState({visible:!0,style:{top:e.offsetTop}})}}},{key:"render",value:function(){return this.state.visible?d["default"].createElement("button",{onClick:this.props.addMedia,className:"add-button",style:this.state.style},"+"):null}}]),t}(s.Component);f.propTypes={addMedia:s.PropTypes.func},n["default"]=f,t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":16}],3:[function(e,t,n){(function(o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,l=i(r),a=e("draft-js");n["default"]=function(e){var t=a.Entity.get(e.block.getEntityAt(0)),n=t.getData(),o=t.getType();return"image"===o?l["default"].createElement("div",{className:"block-atomic-wrapper"},l["default"].createElement("img",{src:n.src}),l["default"].createElement("div",{className:"block-atomic-controls"},l["default"].createElement("button",null,"Ã—"))):l["default"].createElement("p",null,"No supported block for ",o)},t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"draft-js":void 0}],4:[function(e,t,n){(function(o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,l=i(r),a=e("draft-js");n["default"]=function(e){return l["default"].createElement("cite",null,l["default"].createElement(a.EditorBlock,e))},t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"draft-js":void 0}],5:[function(e,t,n){(function(o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,l=i(r),a=e("draft-js");n["default"]=function(e){return l["default"].createElement(a.EditorBlock,e)},t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"draft-js":void 0}],6:[function(e,t,n){(function(o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,l=i(r),a=e("draft-js"),u=e("./stylebutton"),s=i(u),d=function(e){var t=e.editorState,n=a.RichUtils.getCurrentBlockType(t);return console.log(e),l["default"].createElement("div",{className:"RichEditor-controls"},e.buttons.map(function(t){return l["default"].createElement(s["default"],{key:t.label,active:t.style===n,label:t.label,onToggle:e.onToggle,style:t.style})}))};d.propTypes={editorState:r.PropTypes.any,buttons:r.PropTypes.array,onToggle:r.PropTypes.func},n["default"]=d,t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./stylebutton":10,"draft-js":void 0}],7:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./blocks/blockquotecaption"),r=o(i),l=e("./blocks/caption"),a=o(l),u=e("./blocks/atomic"),s=o(u);n["default"]=function(e){var t=e.getType();switch(t){case"block-quote-caption":return{component:r["default"]};case"caption":return{component:a["default"]};case"atomic":return{component:s["default"],editable:!1};default:return null}},t.exports=n["default"]},{"./blocks/atomic":3,"./blocks/blockquotecaption":4,"./blocks/caption":5}],8:[function(e,t,n){(function(t){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i="undefined"!=typeof window?window.React:"undefined"!=typeof t?t.React:null,r=o(i),l=e("draft-js"),a=function(e,t){e.findEntityRanges(function(e){var t=e.getEntity();return null!==t&&"LINK"===l.Entity.get(t).getType()},t)};n.findLinkEntities=a,n["default"]=function(e){var t=l.Entity.get(e.entityKey).getData(),n=t.url;return r["default"].createElement("a",{className:"draft-link hint--bottom",href:n,target:"_blank"},e.children)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"draft-js":void 0}],9:[function(e,t,n){(function(o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,l=i(r),a=e("./stylebutton"),u=i(a);n["default"]=function(e){var t=e.editorState.getCurrentInlineStyle();return l["default"].createElement("div",{className:"RichEditor-controls"},e.buttons.map(function(n){return l["default"].createElement(u["default"],{key:n.style,active:t.has(n.style),label:n.label,onToggle:e.onToggle,style:n.style})}))},t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./stylebutton":10}],10:[function(e,t,n){(function(e){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=function(e,t,n){for(var o=!0;o;){var i=e,r=t,l=n;o=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,r);if(void 0!==a){if("value"in a)return a.value;var u=a.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(i);if(null===s)return;e=s,t=r,n=l,o=!0,a=s=void 0}},u="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,s=o(u),d=function(e){function t(){var e=this;i(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.onToggle=function(t){t.preventDefault(),e.props.onToggle(e.props.style)}}return r(t,e),l(t,[{key:"render",value:function(){var e="RichEditor-styleButton";return this.props.active&&(e+=" RichEditor-activeButton"),s["default"].createElement("span",{className:e,onMouseDown:this.onToggle},this.props.label)}}]),t}(s["default"].Component);n["default"]=d,t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(e,t,n){(function(o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function(e,t,n){for(var o=!0;o;){var i=e,r=t,l=n;o=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,r);if(void 0!==a){if("value"in a)return a.value;var u=a.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(i);if(null===s)return;e=s,t=r,n=l,o=!0,a=s=void 0}},s="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,d=i(s),c=e("react-dom"),f=i(c),p=e("draft-js"),h=e("./blocktoolbar"),y=i(h),g=e("./inlinetoolbar"),b=i(g),v=e("../util/index"),m=e("../model/index");window.getVisibleSelectionRect=p.getVisibleSelectionRect;var w=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={showURLInput:!1,urlInputValue:"",style:{top:0,left:0}},this.onKeyDown=this.onKeyDown.bind(this),this.onChange=this.onChange.bind(this),this.showLinkInput=this.showLinkInput.bind(this),this.hasDimension=!1,this.rect={},this.forceHide=!1}return l(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.editorState;if(e.editorEnabled){var n=t.getSelection();if(n.isCollapsed())return void(this.state.showURLInput&&this.setState({showURLInput:!1}));var o=(0,v.getSelection)(window);if(o.rangeCount){var i=(o.getRangeAt(0).startContainer.parentNode,(0,v.getSelectionRect)(o)),r={element:document.getElementsByClassName("public-DraftEditor-content")[0].children[0]};r.rect=r.element.getBoundingClientRect();var l={element:document.body};if(l.rect=l.element.getBoundingClientRect(),this.hasDimension){var a=i.left-r.rect.left+(i.width-this.rect.width)/2;i.width>=r.rect.width&&(a=(r.rect.width-this.rect.width)/2),a=Math.max(Math.min(a,r.rect.width-this.rect.width),0),this.setState({style:{top:i.top-l.rect.top-this.rect.height-40,width:this.rect.width,left:a}})}else this.setState({style:{top:i.top-l.rect.top-95,left:Math.max(Math.min((i.left+i.width-341)/2,r.rect.width-this.rect.width),0),width:341}})}}}},{key:"componentDidUpdate",value:function(){this.forceHide=!1;var e=f["default"].findDOMNode(this);e&&(this.rect=f["default"].findDOMNode(this).getBoundingClientRect(),this.hasDimension=!0)}},{key:"onKeyDown",value:function(e){var t=this;13===e.which?(e.preventDefault(),e.stopPropagation(),this.props.setLink(this.state.urlInputValue),this.setState({showURLInput:!1,urlInputValue:""},function(){return t.props.focus()})):27===e.which&&(e.preventDefault(),e.stopPropagation(),this.setState({showURLInput:!1,urlInputValue:""},function(){return t.props.focus()}))}},{key:"onChange",value:function(e){this.setState({urlInputValue:e.target.value})}},{key:"showLinkInput",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];n||(e.preventDefault(),e.stopPropagation());var o=this.props.editorState,i=o.getSelection();if(i.isCollapsed())return void this.props.focus();var r=(0,m.getCurrentBlock)(o),l="",a=!1;r.findEntityRanges(function(e){var t=e.getEntity();return l=t,null!==t&&"LINK"===p.Entity.get(t).getType()},function(e,n){var o=i.getAnchorOffset(),r=i.getFocusOffset();if(i.getIsBackward()&&(o=i.getFocusOffset(),r=i.getAnchorOffset()),e==o&&n==r){a=!0;var u=p.Entity.get(l).getData(),s=u.url;t.setState({showURLInput:!0,urlInputValue:s},function(){setTimeout(function(){t.refs.urlinput.focus(),t.refs.urlinput.select()},0)})}}),a||this.setState({showURLInput:!0},function(){setTimeout(function(){t.refs.urlinput.focus()},0)})}},{key:"render",value:function(){var e=this.props,t=e.editorState,n=e.editorEnabled,o=this.state,i=o.showURLInput,r=o.urlInputValue,l=o.style;return!n||t.getSelection().isCollapsed()?null:i?d["default"].createElement("div",{className:"editor-toolbar",style:l},d["default"].createElement("div",{className:"RichEditor-controls",style:{display:"block"}},d["default"].createElement("input",{ref:"urlinput",type:"text",className:"url-input",onKeyDown:this.onKeyDown,onChange:this.onChange,placeholder:"Press ENTER or ESC",value:r}))):d["default"].createElement("div",{className:"editor-toolbar",style:l},d["default"].createElement(y["default"],{editorState:t,onToggle:this.props.toggleBlockType,buttons:k}),d["default"].createElement(b["default"],{editorState:t,onToggle:this.props.toggleInlineStyle,buttons:S}),d["default"].createElement("div",{className:"RichEditor-controls"},d["default"].createElement("a",{className:"RichEditor-linkButton",href:"#",onClick:this.showLinkInput},"#")))}}]),t}(d["default"].Component);n["default"]=w;var k=[{label:"T",style:"header-three"},{label:"N",style:"unstyled"},{label:"Q",style:"blockquote"},{label:"UL",style:"unordered-list-item"},{label:"OL",style:"ordered-list-item"}],S=[{label:d["default"].createElement("b",null,"B"),style:"BOLD"},{label:d["default"].createElement("i",null,"I"),style:"ITALIC"},{label:d["default"].createElement("u",null,"U"),style:"UNDERLINE"},{label:d["default"].createElement("strike",null,"S"),style:"STRIKETHROUGH"},{label:"Hi",style:"HIGHLIGHT"}];t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../model/index":13,"../util/index":16,"./blocktoolbar":6,"./inlinetoolbar":9,"draft-js":void 0,"react-dom":void 0}],12:[function(e,t,n){(function(o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){switch(e.getType()){case"blockquote":return"block block-quote RichEditor-blockquote";case"unstyled":return"block block-paragraph";case"atomic":return"block block-atomic";case"caption":return"block block-caption";case"block-quote-caption":return"block block-quote RichEditor-blockquote block-quote-caption";default:return"block"}}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=function(e,t,n){for(var o=!0;o;){var i=e,r=t,l=n;o=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,r);if(void 0!==a){if("value"in a)return a.value;var u=a.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(i);if(null===s)return;e=s,t=r,n=l,o=!0,a=s=void 0}},d="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,c=i(d),f=e("draft-js"),p=e("immutable"),h=e("./components/addbutton"),y=i(h),g=e("./components/toolbar"),b=i(g),v=e("./components/customrenderer"),m=i(v),w=(e("./util"),e("./model/rendermap")),k=i(w),S=e("./util/keybinding"),E=i(S),R=e("./util/beforeinput"),C=i(R),T=e("./model"),O=e("./components/entities/link"),_=i(O),M={HIGHLIGHT:{backgroundColor:"yellow"},CODE:{fontFamily:'Consolas, "Liberation Mono", Menlo, Courier, monospace',margin:"4px 0",fontSize:"0.9em",padding:"1px 3px",color:"#555",backgroundColor:"#fcfcfc",border:"1px solid #ccc",borderBottomColor:"#bbb",borderRadius:3,boxShadow:"inset 0 -1px 0 #bbb"}},j=function(e){function t(e){var n=this;r(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var o=new f.CompositeDecorator([{strategy:O.findLinkEntities,component:_["default"]}]);this.state={editorState:f.EditorState.createEmpty(o),showURLInput:!1,editorEnabled:!0,urlValue:""},e.value&&(this.state.editorState=f.EditorState.push(this.state.editorState,(0,f.convertFromRaw)(e.value))),this.focus=function(){return n.refs.editor.focus()},this.onChange=function(e){window.editorState=e,n.setState({editorState:e})},this.onClick=function(){n.state.editorEnabled||n.setState({editorEnabled:!0},function(){n.focus()})},this.logData=this.logData.bind(this),this.onClick=this.onClick.bind(this),this.onTab=this.onTab.bind(this),this.handleKeyCommand=this.handleKeyCommand.bind(this),this.handleBeforeInput=this.handleBeforeInput.bind(this),this.handleReturn=this.handleReturn.bind(this),this.toggleBlockType=this._toggleBlockType.bind(this),this.toggleInlineStyle=this._toggleInlineStyle.bind(this),this.toggleEdit=this.toggleEdit.bind(this),this.loadSavedData=this.loadSavedData.bind(this),this.setLink=this.setLink.bind(this),this.addMedia=this.addMedia.bind(this)}return l(t,e),u(t,[{key:"componentDidMount",value:function(){this.focus()}},{key:"onTab",value:function(e){var t=this.state.editorState,n=f.RichUtils.onTab(e,t,2);n!==t&&this.onChange(n)}},{key:"logData",value:function(e){o.RAW=(0,f.convertToRaw)(this.state.editorState.getCurrentContent()),o.SEL=this.state.editorState.getSelection(),console.log("RAW",o.RAW),console.log("SEL",o.SEL.toJS())}},{key:"setLink",value:function(e){var t=this,n=this.state.editorState,o=n.getSelection(),i=null;""!==e&&(i=f.Entity.create("LINK","MUTABLE",{url:e})),this.setState({editorState:f.RichUtils.toggleLink(n,o,i)},function(){setTimeout(function(){return t.refs.editor.focus()},0)})}},{key:"addMedia",value:function(){var e=window.prompt("Enter a URL");if(e){var t=f.Entity.create("image","IMMUTABLE",{src:e});this.onChange(f.AtomicBlockUtils.insertAtomicBlock(this.state.editorState,t," "))}}},{key:"handleDroppedFiles",value:function(e,t){console.log(e.toJS()),console.log(t)}},{key:"handleKeyCommand",value:function(e){if("editor-save"===e)return window.localStorage.editor=JSON.stringify((0,f.convertToRaw)(this.state.editorState.getCurrentContent())),window.localStorage.tmp=JSON.stringify((0,f.convertToRaw)(this.state.editorState.getCurrentContent())),!0;if("showlinkinput"===e)return this.refs.toolbar&&this.refs.toolbar.showLinkInput(null,!0),!0;if("add-new-block"===e){var t=this.state.editorState;return this.onChange((0,T.addNewBlock)(t,"blockquote")),!0}if("load-saved-data"===e)return this.loadSavedData(),!0;var n=this.state.editorState,o=(0,T.getCurrentBlock)(n);if(0==e.indexOf("changetype:")){var i=e.split(":")[1],r=o.getType();return"atomic"==r||"media"==r?!1:("blockquote"==r&&"caption"==i?i="block-quote-caption":"block-quote-caption"==r&&"caption"==i&&(i="blockquote"),this.onChange(f.RichUtils.toggleBlockType(n,i)),!0)}var l=f.RichUtils.handleKeyCommand(n,e);return l?(this.onChange(l),!0):!1}},{key:"handleBeforeInput",value:function(e){return this.props.beforeInput(this.state.editorState,e,this.onChange,this.props.stringToTypeMap)}},{key:"handleReturn",value:function(e){return e.shiftKey?(this.setState({editorState:f.RichUtils.insertSoftNewline(this.state.editorState)}),!0):!1}},{key:"_toggleBlockType",value:function(e){this.onChange(f.RichUtils.toggleBlockType(this.state.editorState,e))}},{key:"_toggleInlineStyle",value:function(e){this.onChange(f.RichUtils.toggleInlineStyle(this.state.editorState,e))}},{key:"toggleEdit",value:function(e){this.setState({editorEnabled:!this.state.editorEnabled})}},{key:"loadSavedData",value:function(){var e=this,t=window.localStorage.getItem("editor");if(null===t)return void console.log("No data found.");try{var n=JSON.parse(t);console.log(n),this.setState({editorState:f.EditorState.push(this.state.editorState,(0,f.convertFromRaw)(n))},function(){return e.refs.editor.focus()})}catch(o){window.er=o,console.log(o),console.log("Could not load data.")}}},{key:"loadCustomData",value:function(e){var t=this;this.setState({editorState:f.EditorState.push(this.state.editorState,e)},function(){return t.refs.editor.focus()})}},{key:"render",value:function(){var e=this.state,t=e.editorState,n=(e.showURLInput,e.editorEnabled);e.urlValue;return o.editor=this,c["default"].createElement("div",{className:"RichEditor-root"},c["default"].createElement("div",{className:"RichEditor-editor"},c["default"].createElement(f.Editor,{ref:"editor",editorState:t,blockRendererFn:m["default"],blockStyleFn:a,onChange:this.onChange,onTab:this.onTab,blockRenderMap:this.props.blockRenderMap,handleKeyCommand:this.handleKeyCommand,handleBeforeInput:this.handleBeforeInput,handleDroppedFiles:this.handleDroppedFiles,handleReturn:this.handleReturn,customStyleMap:M,readOnly:!n,keyBindingFn:E["default"],placeholder:"Write your story",spellCheck:!1}),n?c["default"].createElement(y["default"],{editorState:t,addMedia:this.addMedia}):null,c["default"].createElement(b["default"],{ref:"toolbar",editorState:t,toggleBlockType:this.toggleBlockType,toggleInlineStyle:this.toggleInlineStyle,editorEnabled:n,setLink:this.setLink,focus:this.focus})),c["default"].createElement("div",{className:"editor-action"},c["default"].createElement("button",{onClick:this.logData},"Log State"),c["default"].createElement("button",{onClick:this.toggleEdit},"Toggle Edit")))}}]),t}(c["default"].Component);(0,p.Map)();j.defaultProps={beforeInput:C["default"],stringToTypeMap:R.StringToTypeMap,blockRenderMap:k["default"]},n["default"]=j,t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./components/addbutton":2,"./components/customrenderer":7,"./components/entities/link":8,"./components/toolbar":11,"./model":13,"./model/rendermap":14,"./util":16,"./util/beforeinput":15,"./util/keybinding":17,"draft-js":void 0,immutable:void 0}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("draft-js"),i=function(e){var t=e.getSelection(),n=e.getCurrentContent(),o=n.getBlockForKey(t.getStartKey());return o};n.getCurrentBlock=i;var r=function(e){var t=arguments.length<=1||void 0===arguments[1]?"unstyled":arguments[1],n=e.getSelection();if(!n.isCollapsed())return console.log("selection not collapsed"),e;var r=e.getCurrentContent(),l=n.getStartKey(),a=r.getBlockMap(),u=i(e);if(!u)return console.log("no current block"),e;if(0==u.getLength()){if(u.getType()==t)return console.log("same block types"),e;var s=u.merge({type:t}),d=r.merge({blockMap:a.set(l,s),selectionAfter:n});return o.EditorState.push(e,d,"change-block-type")}return console.log("block length > 0"),e};n.addNewBlock=r;var l=function(e){var t=arguments.length<=1||void 0===arguments[1]?"unstyled":arguments[1],n=e.getCurrentContent(),i=e.getSelection(),r=i.getStartKey(),l=n.getBlockMap(),a=l.get(r),u="",s=a.getText();a.getLength()>=2&&(u=s.substr(1));var d=a.merge({text:u,type:t}),c=n.merge({blockMap:l.set(r,d),selectionAfter:i.merge({anchorOffset:0,focusOffset:0})});return o.EditorState.push(e,c,"change-block-type")};n.resetBlockWithType=l},{"draft-js":void 0}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("immutable"),i=e("draft-js"),r=(0,o.Map)({unstyled:{element:"div"},caption:{element:"cite"},"block-quote-caption":{element:"blockquote"}}).merge(i.DefaultDraftBlockRenderMap);n["default"]=r,t.exports=n["default"]},{"draft-js":void 0,immutable:void 0}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("../model/index"),i=e("ramda"),r=(0,i.addIndex)(i.forEach),l={"--":"blockquote:block-quote-caption:caption","//":"blockquote",'""':"blockquote","''":"blockquote","*.":"unordered-list-item","1.":"ordered-list-item","##":"header-two","==":"unstyled"};n.StringToTypeMap=l,n["default"]=function(e,t,n){var a=arguments.length<=3||void 0===arguments[3]?l:arguments[3],u=e.getSelection(),s=(0,o.getCurrentBlock)(e),d=s.getType(),c=s.getLength();if(u.getAnchorOffset()>1||c>1)return!1;var f=a[s.getText()[0]+t];if(!f)return!1;var p=f.split(":");if(p.length<1||p.length>3)return!1;var h=p[0];return d===(0,i.last)(p)?!1:(h=(0,i.last)(p),r(function(e,t,n){d===e&&(h=n[t+1])},(0,i.dropLast)(1,p)),n((0,o.resetBlockWithType)(e,h)),!0)}},{"../model/index":13,ramda:void 0}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){var t=e.getRangeAt(0).getBoundingClientRect(),n=t&&t.top?t:e.getRangeAt(0).getClientRects()[0];if(!n){if(!e.anchorNode||!e.anchorNode.getBoundingClientRect)return null;n=e.anchorNode.getBoundingClientRect(),n.isEmptyline=!0}return n};n.getSelectionRect=o;var i=function(e){var t=null;return e.getSelection?t=e.getSelection():e.document.getSelection?t=e.document.getSelection():e.document.selection&&(t=e.document.selection.createRange().text),t};n.getSelection=i;var r=function(e){var t=e.getSelection();if(0==t.rangeCount)return null;window.sel=t;var n=t.getRangeAt(0).startContainer;do{if(n.getAttribute&&"true"===n.getAttribute("data-block"))return n;n=n.parentNode}while(null!==n);return null};n.getSelectedBlockNode=r},{}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("draft-js"),i=o.KeyBindingUtil.hasCommandModifier;n["default"]=function(e){if(i(e)&&83==e.keyCode)return"editor-save";if(e.altKey===!0){if(e.shiftKey===!0)switch(e.keyCode){case 65:return"add-new-block";case 68:return"load-saved-data";case 69:return"toggle-edit-mode";default:return(0,o.getDefaultKeyBinding)(e)}switch(e.keyCode){case 49:return"changetype:ordered-list-item";case 50:return"showlinkinput";case 51:return"changetype:header-three";case 56:return"changetype:unordered-list-item";case 188:return"changetype:caption";case 190:return"changetype:unstyled";case 222:return"changetype:blockquote";default:return(0,o.getDefaultKeyBinding)(e)}}return(0,o.getDefaultKeyBinding)(e)},t.exports=n["default"]},{"draft-js":void 0}]},{},[1])(1)});